{% extends 'accounts/base.html' %}
{% load widget_tweaks %}
{% block title %}eDCMS-Add documents{% endblock title %}
{% load crispy_forms_tags %}
{% block content %}
 <head>
     <div class="container" style="margin-top : 20px">
      {% if messages %}
                    {% for message in messages %}
                    <div class="alert alert-dark alert-dismissible text-center col-md-4" role="alert" style="margin:0px auto">
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <small class="text-muted">{{ message }}</small>
                    </div>
                    {% endfor %}
      {% endif %}
     </div>
 </head>
<body>
<div class ="container" style="margin-top:30px">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{% url 'recordmgnts:records' %}">Records</a></li>
        <li class="breadcrumb-item active">New container</li>
    </ol>
</div>
<div class="container" style="margin-top:30px">
    <button class="btn btn-info" onclick="on_barcode_scanner();">Scan barcode</button>
<form method="POST" id="contForm" data-bays-url="{% url 'recordmgnts:ajax_load_locations' %}" novalidate>
    {% csrf_token %}
        <div class="form-row align-items-center">
              <div class="form-group col-md-8 mb-0">
                {{ form.container_serial_number|as_crispy_field }}
              </div>
        </div>
            {{ form.container_description|as_crispy_field }}
            {{ form.warehouse|as_crispy_field }}
        <div class="form-row">
              <div class="form-group col-md-4 mb-0">
                {{ form.bay|as_crispy_field }}
              </div>
              <div class="form-group col-md-4 mb-0">
                {{ form.row|as_crispy_field }}
              </div>
              <div class="form-group col-md-4 mb-0">
                {{ form.column|as_crispy_field }}
              </div>
        </div>
<!--    {% for field in form.visible_fields %}-->
<!--                    <div class="form-group">-->
<!--                        <b>{{ field.label_tag }}</b>-->
<!--                        {% if form.is_bound %}-->
<!--                        {% if field.errors %}-->
<!--                        {% render_field field class="form-control is-invalid" %}-->
<!--                        {% for error in field.errors %}-->
<!--                        <div class="invalid-feedback">-->
<!--                            {{ error }}-->
<!--                        </div>-->
<!--                        {% endfor %}-->
<!--                        {% else %}-->
<!--                        {% render_field field class="form-control is-valid" %}-->
<!--                        {% endif %}-->
<!--                        {% else %}-->
<!--                        {% render_field field class="form-control" %}-->
<!--                        {% endif %}-->

<!--                        {% if field.help_text %}-->
<!--                        <small class="form-text text-muted">{{ field.help_text }}</small>-->
<!--                        {% endif %}-->
<!--                    </div>-->
<!--    {% endfor %}-->
    <button type="submit" class="btn btn-info col-md-2" style="margin-top:20px">Add</button>
</form>
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script>
    $("#id_warehouse").change(function(){
        var url = $("#contForm").attr("data-bays-url");
        var warehouseId =$(this).val();
        $.ajax({
            url: url,
            data: {
            'warehouse': warehouseId
            },
            success: function(data){
                $("#id_bay").html(data);
            }
        });
    });

    function on_barcode_scanner(){
        var url = "{% url 'recordmgnts:barcode_scanner' %}";
        $.ajax({
            url: url,
            success: function(data){
                $("#id_container_serial_number").attr("value",data);
            }
        });
    };
</script>
</div>
</body>
{% endblock content %}
